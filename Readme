#â˜ï¸ Firebase Storage Bulk Synchronizer
###Script de Carga Masiva para PadrÃ³n FotogrÃ¡fico

![NodeJS](https://img.shields.io/badge/node.js-v14+-6DA55F?style=for-the-badge&logo=node.js&logoColor=white)
![Firebase](https://img.shields.io/badge/firebase-admin-ffca28?style=for-the-badge&logo=firebase&logoColor=black)


SincronizaciÃ³n inteligente de imÃ¡genes locales a Firebase Storage con sistema de recuperaciÃ³n de fallos.

---

##âš¡ CaracterÃ­sticas Principales

* **ğŸ”„ Sistema de Resume (Continuidad):** Si el proceso se interrumpe (pÃ©rdida de internet, apagÃ³n), el script guarda el estado en `progreso.json`. Al reiniciar, detecta la sesiÃ³n anterior y continÃºa exactamente donde se quedÃ³.
* **ğŸš€ Concurrencia Controlada:** Procesa subidas en lotes de **15 archivos simultÃ¡neos** (configurable) para maximizar el ancho de banda sin saturar la red.
* **ğŸ§  Smart Diffing:** Evita resubir archivos existentes comparando tu carpeta local contra una lista pre-generada de la nube (`lista_storage.txt`).
* **ğŸ“ OrganizaciÃ³n AutomÃ¡tica:** Sube las imÃ¡genes desde la carpeta local `./fotos` hacia la ruta remota `votantes_fotos/`.

---

##ğŸ› ï¸ Requisitos y ConfiguraciÃ³n

###1. Prerrequisitos

* **Node.js** instalado.
* **Cuenta de Servicio de Firebase:** Archivo `.json` con permisos de escritura en Storage.

###2. Estructura de Archivos Esperada

El script asume la siguiente estructura de directorios:

```text
ğŸ“¦ tu-proyecto
 â”£ ğŸ“‚ fotos                   <-- Coloca aquÃ­ las imÃ¡genes (.jpg, .png) a subir
 â”£ ğŸ“‚ src
 â”ƒ â”— ğŸ“‚ data
 â”ƒ   â”— ğŸ“œ lista_storage.txt   <-- Lista de archivos ya existentes en la nube (generada con gsutil o similar)
 â”£ ğŸ“œ cargarPadron.js         <-- Este script
 â”— ğŸ“œ service-account.json    <-- Tu archivo de credenciales (nombre puede variar)
````

###3\. ConfiguraciÃ³n del Script

Abre `cargarPadron.js` y edita la secciÃ³n de **CONFIGURACIÃ“N** al inicio del archivo:

```javascript
// Debes completar estas variables antes de ejecutar:
const SERVICE_ACCOUNT = "./path/a/tu/service-account.json"; // Ruta a tu llave JSON
const BUCKET_NAME = "tu-proyecto.appspot.com";              // Nombre de tu bucket
```

-----

##ğŸš€ Modo de Uso

1.  **Instalar dependencias:**

    ```bash
    npm install firebase-admin
    ```

2.  **Ejecutar el script:**

    ```bash
    node cargarPadron.js
    ```

3.  **Flujo de ejecuciÃ³n:**

      * El script verificarÃ¡ si existe una sesiÃ³n previa (`progreso.json`).
      * Si es una nueva sesiÃ³n, compararÃ¡ `./fotos` con `./src/data/lista_storage.txt` para identificar faltantes.
      * Se te pedirÃ¡ confirmaciÃ³n para iniciar la carga: `(s/n)`.
      * VerÃ¡s una barra de progreso con el porcentaje y archivos restantes.

-----

##ğŸ“ Archivos Generados

El script genera automÃ¡ticamente estos archivos para control:

  * `progreso.json`: Base de datos temporal de archivos pendientes. **No borrar** si deseas resumir la carga luego. Se borra automÃ¡ticamente al finalizar con Ã©xito.
  * `faltantes_lista.txt`: Lista legible por humanos de todos los archivos que faltan por subir al momento del escaneo.

-----

##âš ï¸ Notas Importantes

  * **Lista de Storage:** El archivo `lista_storage.txt` es crucial para no duplicar trabajo. AsegÃºrate de que contenga los nombres de los archivos que YA estÃ¡n en la nube (puede estar codificado en UTF-8 o UTF-16).
  * **Formatos:** Solo se procesan archivos con extensiÃ³n `.jpg`, `.jpeg` o `.png`.




